# ν…μ¤νΈ μƒμ„± λ¨λΈ λ‹¨κ³„λ³„ ν•™μµ κ°€μ΄λ“

## π“‹ κ°μ”

μ΄ ν”„λ΅μ νΈλ” **GPT2 κΈ°λ° ν•κµ­μ–΄ ν…μ¤νΈ μƒμ„± λ¨λΈ**μ„ λ‹¨κ³„λ³„λ΅ ν•™μµν•  μ μλ„λ΅ μ„¤κ³„λ κµμ΅μ© μλ£μ…λ‹λ‹¤. μκ°•μƒλ“¤μ€ 5λ‹¨κ³„μ— κ±Έμ³ ν…μ¤νΈ μƒμ„±μ ν•µμ‹¬ κ°λ…κ³Ό μ‹¤λ¬΄ κµ¬ν„ λ°©λ²•μ„ μ²΄κ³„μ μΌλ΅ ν•™μµν•  μ μμµλ‹λ‹¤.

## π― ν•™μµ λ©ν‘

- **GPT2 μ–Έμ–΄ λ¨λΈ**μ κµ¬μ΅°μ™€ μ‘λ™ μ›λ¦¬ μ΄ν•΄
- **λ‹¤μ–‘ν• μƒμ„± μ „λµ**κ³Ό νλΌλ―Έν„° ν¨κ³Ό μ²΄ν—
- **λ¨λΈ Fine-tuning** κ³Όμ •κ³Ό Transfer Learning κ°λ… ν•™μµ
- **μ‹¤μ‹κ°„ ν…μ¤νΈ μƒμ„± μ›Ή μ„λΉ„μ¤** κµ¬μ¶• λ¥λ ¥ νλ“
- **μ°½μμ  AI μ• ν”λ¦¬μΌ€μ΄μ…** κ°λ° κΈ°μ΄ μµλ“

## π“ λ‹¨κ³„λ³„ κµ¬μ„±

### π”· Step 1: ν…μ¤νΈ μƒμ„± κΈ°λ³Έ κ°λ…
**νμΌ**: `step1_basic_generation.py`

**ν•™μµ λ‚΄μ©**:
- GPT2 λ¨λΈ κµ¬μ΅°μ™€ AutoRegressive Generation μ΄ν•΄
- κΈ°λ³Έ ν…μ¤νΈ μƒμ„± νμ΄ν”„λΌμΈ κµ¬ν„
- Greedy Searchμ νΉμ§•κ³Ό ν•κ³„ μ²΄ν—

**ν•µμ‹¬ TODO**:
```python
# ν•κµ­μ–΄ GPT2 λ¨λΈ λ΅λ“
pretrained = # TODO: "skt/kogpt2-base-v2" μ§€μ •

# λ¨λΈκ³Ό ν† ν¬λ‚μ΄μ € μ΄κΈ°ν™”
model = # TODO: GPT2LMHeadModel.from_pretrained() μ‚¬μ©
tokenizer = # TODO: PreTrainedTokenizerFast λ΅λ“

# κΈ°λ³Έ ν…μ¤νΈ μƒμ„±
generated_ids = # TODO: model.generate() νΈμ¶
```

**ν•™μµ ν¬μΈνΈ**:
- `GPT2LMHeadModel`: Causal Language Modelμ λ€ν‘μ  κµ¬ν„
- `do_sample=False`: ν™•μ •μ  μƒμ„± (Greedy Search)
- `eos_token="</s>"`: ν•κµ­μ–΄ GPT2μ λ¬Έμ¥ μΆ…λ£ ν† ν°
- AutoRegressive: μ΄μ „ ν† ν°λ“¤μ„ μ΅°κ±΄μΌλ΅ λ‹¤μ ν† ν° μμΈ΅

---

### π”· Step 2: λ‹¤μ–‘ν• μƒμ„± μ „λµ
**νμΌ**: `step2_generation_strategies.py`

**ν•™μµ λ‚΄μ©**:
- Greedy Search vs Beam Search vs Sampling λΉ„κµ
- `do_sample` νλΌλ―Έν„°μ μ—­ν• κ³Ό μ¤‘μ”μ„±
- κ° μ „λµμ μ¥λ‹¨μ κ³Ό μ μ© μ‹λ‚λ¦¬μ¤

**ν•µμ‹¬ TODO**:
```python
# Beam Search μ‹¤ν—
generated_ids = # TODO: num_beams=3 μ¶”κ°€

# Top-k Sampling μ‹¤ν—  
generated_ids = # TODO: do_sample=True, top_k=50

# Top-p (Nucleus) Sampling μ‹¤ν—
generated_ids = # TODO: do_sample=True, top_p=0.92

# λ™μΌ μ„¤μ • λ°λ³µ μ‹¤ν–‰μΌλ΅ λ‹¤μ–‘μ„± ν™•μΈ
for i in range(3):
    generated_ids = # TODO: μƒν”λ§ κΈ°λ²•μΌλ΅ 3ν μƒμ„±
```

**ν•™μµ ν¬μΈνΈ**:
- **Beam Search**: μ „μ²΄μ μΌλ΅ λ” μΆ‹μ€ ν™•λ¥ μ λ¬Έμ¥ νƒμƒ‰
- **Top-k Sampling**: μƒμ„ kκ° ν† ν° μ¤‘ ν™•λ¥ μ  μ„ νƒ
- **Top-p Sampling**: λ„μ  ν™•λ¥  pκΉμ§€μ ν† ν°λ“¤ μ¤‘ μ„ νƒ
- **λ‹¤μ–‘μ„± vs ν’μ§**: μƒμ„± μ „λµ κ°„ νΈλ μ΄λ“μ¤ν”„

---

### π”· Step 3: μƒμ„± νλΌλ―Έν„° μ΅°μ •
**νμΌ**: `step3_parameter_tuning.py`

**ν•™μµ λ‚΄μ©**:
- Temperature, Top-k, Top-p νλΌλ―Έν„° μ‹¬ν™” μ‹¤ν—
- λ°λ³µ λ°©μ§€ κΈ°λ²• (repetition penalty, no_repeat_ngram_size)
- μ‹¤λ¬΄ μµμ ν™” νλΌλ―Έν„° μ΅°ν•© λ°κ²¬

**ν•µμ‹¬ TODO**:
```python
# λ°λ³µ λ°©μ§€ μ‹¤ν—
generated_ids = # TODO: no_repeat_ngram_size=3 μ μ©

# Temperature ν¨κ³Ό μ‹¤ν—
generated_ids = # TODO: temperature κ°’ λ³€ν™”μ‹μΌ λΉ„κµ

# μµμ  νλΌλ―Έν„° μ΅°ν•©
generated_ids = # TODO: ν†µν•© μµμ ν™” μ„¤μ • μ μ©
```

**ν•™μµ ν¬μΈνΈ**:
- **Temperature**: ν™•λ¥  λ¶„ν¬μ λ‚ μΉ΄λ΅μ›€ μ΅°μ  (μ°½μμ„± vs μ•μ •μ„±)
- **Repetition Penalty**: μ΄λ―Έ μ‚¬μ©λ ν† ν°μ μ¬μ¶ν„ μ–µμ 
- **N-gram λ°λ³µ λ°©μ§€**: μμ—°μ¤λ¬μ΄ λ¬Έμ¥ νλ¦„ λ³΄μ¥
- **νλΌλ―Έν„° μ΅°ν•©**: λ„λ©”μΈλ³„ μµμ  μ„¤μ • νƒμƒ‰

---

### π”· Step 4: λ¨λΈ Fine-tuning
**νμΌ**: `step4_model_training.py`

**ν•™μµ λ‚΄μ©**:
- NSMC λ°μ΄ν„°λ¥Ό ν™μ©ν• GPT2 Fine-tuning
- Transfer Learning κ°λ…κ³Ό μ‹¤λ¬΄ μ μ©
- ratsnlp λΌμ΄λΈλ¬λ¦¬λ¥Ό ν™μ©ν• ν¨μ¨μ  ν•™μµ νμ΄ν”„λΌμΈ

**ν•µμ‹¬ TODO**:
```python
# ν•™μµ μ„¤μ • κµ¬μ„±
args = GenerationTrainArguments(
    pretrained_model_name=# TODO: λ¨λΈλ…,
    downstream_corpus_name=# TODO: λ°μ΄ν„°μ…‹λ…,
    batch_size=# TODO: λ°°μΉ ν¬κΈ°,
)

# λ°μ΄ν„°μ…‹κ³Ό λ°μ΄ν„°λ΅λ” κµ¬μ„±
train_dataset = # TODO: GenerationDataset μƒμ„±
train_dataloader = # TODO: DataLoader μ„¤μ •

# λ¨λΈ ν•™μµ μ‹¤ν–‰
trainer.fit(# TODO: task, dataloaders μ „λ‹¬)
```

**ν•™μµ ν¬μΈνΈ**:
- **NSMC λ°μ΄ν„°**: λ„¤μ΄λ²„ μν™” λ¦¬λ·°λ΅ κ°μ • ν‘ν„ ν’λ¶€ν• ν…μ¤νΈ ν•™μµ
- **Fine-tuning**: μΌλ° μ–Έμ–΄ λ¨λΈμ„ νΉμ • λ„λ©”μΈμ— νΉν™”
- **GenerationTask**: Lightning κΈ°λ° μλ™ν™”λ ν•™μµ νμ΄ν”„λΌμΈ
- **Transfer Learning**: μ‚¬μ „ν•™μµλ μ§€μ‹μ„ μƒλ΅μ΄ νƒμ¤ν¬μ— ν™μ©

---

### π”· Step 5: μ›Ή μ„λΉ„μ¤ κµ¬ν„
**νμΌ**: `step5_web_service.py`

**ν•™μµ λ‚΄μ©**:
- Flask κΈ°λ° μ‹¤μ‹κ°„ ν…μ¤νΈ μƒμ„± API κµ¬ν„
- ν•™μµλ λ¨λΈμ„ μ‹¤μ  μ„λΉ„μ¤λ΅ λ°°ν¬
- μ‚¬μ©μ μΉν™”μ  μ›Ή μΈν„°νμ΄μ¤ μ κ³µ

**ν•µμ‹¬ TODO**:
```python
# λ°°ν¬ ν™κ²½ μ„¤μ •
device = # TODO: GPU/CPU λ””λ°”μ΄μ¤ μ„¤μ •
args = # TODO: GenerationDeployArguments κµ¬μ„±

# Fine-tuned λ¨λΈ λ΅λ“
model = # TODO: μ²΄ν¬ν¬μΈνΈμ—μ„ λ¨λΈ λ³µμ›
model.load_state_dict(# TODO: κ°€μ¤‘μΉ λ΅λ“)

# μ¶”λ΅  ν•¨μ κµ¬ν„
def inference_fn(prompt, **kwargs):
    generated_ids = # TODO: νλΌλ―Έν„°λ¥Ό λ°μν• μƒμ„±
    return # TODO: κ²°κ³Ό λ°ν™

# μ›Ή μ„λΉ„μ¤ μ‹¤ν–‰
app = # TODO: Flask μ•± μƒμ„±
app.run(# TODO: μ„λ²„ μ‹¤ν–‰)
```

**ν•™μµ ν¬μΈνΈ**:
- **Model Deployment**: ν•™μµλ λ¨λΈμ μ‹¤μ  μ„λΉ„μ¤ λ°°ν¬
- **Flask API**: RESTful μ›Ή μ„λΉ„μ¤ κµ¬ν„
- **μ‹¤μ‹κ°„ μ¶”λ΅ **: μ‚¬μ©μ μ”μ²­μ— λ€ν• μ¦‰μ‹ μ‘λ‹µ μ‹μ¤ν…
- **νλΌλ―Έν„° μ΅°μ • UI**: μ‚¬μ©μκ°€ μƒμ„± ν’μ§μ„ μ§μ ‘ μ΅°μ 

## π€ μ‹¤ν–‰ λ°©λ²•

### 1λ‹¨κ³„λ¶€ν„° μμ°¨μ  ν•™μµ:
```bash
# Step 1: κΈ°λ³Έ ν…μ¤νΈ μƒμ„± μ΄ν•΄
python step1_basic_generation.py

# Step 2: μƒμ„± μ „λµ λΉ„κµ (TODO μ™„μ„± ν›„)
python step2_generation_strategies.py

# Step 3: νλΌλ―Έν„° νλ‹ (TODO μ™„μ„± ν›„)
python step3_parameter_tuning.py

# Step 4: λ¨λΈ ν•™μµ (TODO μ™„μ„± ν›„)
python step4_model_training.py

# Step 5: μ›Ή μ„λΉ„μ¤ (TODO μ™„μ„± ν›„)
python step5_web_service.py
# λΈλΌμ°μ €μ—μ„ http://localhost:9001 μ ‘μ†
```

## π“ κµμ΅μ  μ¥μ 

### 1. **μ²΄κ³„μ  λ‚μ΄λ„ μ¦κ°€**
- Step 1: κΈ°λ³Έ κ°λ… β†’ Step 5: μ‹¤λ¬΄ μ‹μ¤ν…
- κ° λ‹¨κ³„λ³„ λ…ν™•ν• ν•™μµ λ©ν‘μ™€ μ‹¤μµ κ³Όμ 

### 2. **μ‹¤λ¬΄ μ¤‘μ‹¬ μ»¤λ¦¬νλΌ**
- Production λ λ²¨μ λ¨λΈ ν•™μµκ³Ό λ°°ν¬ κ²½ν—
- μ‹¤μ  μ„λΉ„μ¤μ—μ„ μ‚¬μ© κ°€λ¥ν• μ½”λ“μ™€ μ•„ν‚¤ν…μ²
- λ‹¤μ–‘ν• λΉ„μ¦λ‹μ¤ μ‹λ‚λ¦¬μ¤ λ€μ‘ λ¥λ ¥ λ°°μ–‘

### 3. **μ¦‰μ‹ ν™•μΈ κ°€λ¥ν• κ²°κ³Ό**
- κ° λ‹¨κ³„μ—μ„ λ°”λ΅ μ‹¤ν–‰ν•κ³  κ²°κ³Ό ν™•μΈ
- νλΌλ―Έν„° λ³€ν™”μ— λ”°λ¥Έ μ¦‰μ‹ ν”Όλ“λ°±
- μ‹κ°μ μΌλ΅ μ΄ν•΄ν•κΈ° μ‰¬μ΄ ν…μ¤νΈ μƒμ„± κ²°κ³Ό

### 4. **ν™•μ¥ κ°€λ¥ν• ν•™μµ κµ¬μ΅°**
- λ‹¤λ¥Έ μ–Έμ–΄ λ¨λΈλ΅ ν™•μ¥ κ°€λ¥ (KoGPT-Trinity, Polyglot-ko λ“±)
- λ‹¤μ–‘ν• λ„λ©”μΈ λ°μ΄ν„°λ΅ μ¶”κ°€ μ‹¤ν— κ°€λ¥
- μµμ‹  μƒμ„± λ¨λΈ μ—°κµ¬ νΈλ λ“ λ°μ μ©μ΄

## π”§ GitHub λ°°ν¬ μ „λµ

### Repository κµ¬μ΅°:
```
task3-gen/
β”β”€β”€ step1_basic_generation.py      # 1λ‹¨κ³„: κΈ°λ³Έ μƒμ„± κ°λ…
β”β”€β”€ step2_generation_strategies.py # 2λ‹¨κ³„: μƒμ„± μ „λµ λΉ„κµ
β”β”€β”€ step3_parameter_tuning.py      # 3λ‹¨κ³„: νλΌλ―Έν„° μ΅°μ •
β”β”€β”€ step4_model_training.py        # 4λ‹¨κ³„: λ¨λΈ Fine-tuning
β”β”€β”€ step5_web_service.py           # 5λ‹¨κ³„: μ›Ή μ„λΉ„μ¤ κµ¬ν„
β”β”€β”€ solutions/                     # λ‹¨κ³„λ³„ ν•΄λ‹µ
β”‚   β”β”€β”€ step1_solution.py
β”‚   β”β”€β”€ step2_solution.py
β”‚   β”β”€β”€ step3_solution.py
β”‚   β”β”€β”€ step4_solution.py
β”‚   β””β”€β”€ step5_solution.py
β”β”€β”€ templates/                     # μ›Ή UI ν…ν”λ¦Ώ
β””β”€β”€ README_stepwise_learning.md    # μ΄ νμΌ
```

### μμ—… μ§„ν–‰ λ°©μ‹:
1. **μ΄λ΅  + μ‹¤μµ**: κ° λ‹¨κ³„λ³„ κ°λ… μ„¤λ… ν›„ λ°”λ΅ μ‹¤μµ
2. **μ μ§„μ  κ³µκ°**: μ΄μ „ λ‹¨κ³„ μ™„λ£ ν›„ λ‹¤μ λ‹¨κ³„ μ ‘κ·Ό ν—μ©
3. **ν”Όμ–΄ λ¦¬λ·°**: ν•™μƒλ“¤ κ°„ μ½”λ“ λ¦¬λ·°μ™€ κ²°κ³Ό κ³µμ 
4. **μ°½μμ  ν”„λ΅μ νΈ**: μµμΆ… λ‹¨κ³„μ—μ„ κ°μΈλ³„ μ• ν”λ¦¬μΌ€μ΄μ… κ°λ°

## π“– ν•µμ‹¬ κ°λ… λΉ„κµ

| κ°λ… | λ¶„λ¥/NER | ν…μ¤νΈ μƒμ„± |
|------|----------|-------------|
| **λ¨λΈ νƒ€μ…** | Encoder (BERT) | Decoder (GPT) |
| **ν•™μµ λ©ν‘** | λΌλ²¨ μμΈ΅ | λ‹¤μ ν† ν° μμΈ΅ |
| **μ¶λ ¥** | κ³ μ •λ ν΄λμ¤ | κ°€λ³€ κΈΈμ΄ μ‹ν€€μ¤ |
| **ν‰κ°€ κΈ°μ¤€** | Accuracy, F1 | Perplexity, μΈκ°„ ν‰κ°€ |
| **μ£Όμ” λ„μ „** | λΌλ²¨ λ¶κ· ν• | λ°λ³µ, μΌκ΄€μ„± |
| **μ‘μ© λ¶„μ•Ό** | λ¬Έμ„ λ¶„λ¥, μ •λ³΄ μ¶”μ¶ | μ°½μ‘, λ€ν™”, μ”μ•½ |

## π ν™•μ¥ ν•™μµ μ£Όμ 

### κ³ κΈ‰ μƒμ„± κΈ°λ²•:
- **Contrastive Search**: μµμ‹  λ””μ½”λ”© μ•κ³ λ¦¬μ¦
- **FUDGE**: μ μ–΄ κ°€λ¥ν• ν…μ¤νΈ μƒμ„±
- **Prompt Engineering**: ν¨κ³Όμ μΈ ν”„λ΅¬ν”„νΈ μ„¤κ³„

### ν‰κ°€ λ° μµμ ν™”:
- **BLEU, ROUGE**: μλ™ ν‰κ°€ λ©”νΈλ¦­
- **Human Evaluation**: μΈκ°„ ν‰κ°€ μ‹¤ν— μ„¤κ³„
- **A/B Testing**: μ„λΉ„μ¤ ν’μ§ μµμ ν™”

### μ‹¤λ¬΄ κ³ λ ¤μ‚¬ν•­:
- **Content Filtering**: λ¶€μ μ ν• λ‚΄μ© ν•„ν„°λ§
- **Bias Detection**: νΈν–¥μ„± νƒμ§€ λ° μ™„ν™”
- **Scalability**: λ€κ·λ¨ μ„λΉ„μ¤ μ•„ν‚¤ν…μ²

μ΄ λ‹¨κ³„λ³„ ν•™μµμ„ ν†µν•΄ μκ°•μƒλ“¤μ€ ν…μ¤νΈ μƒμ„± λ¨λΈμ μ΄λ΅ μ  μ΄ν•΄λ¶€ν„° μ‹¤λ¬΄ μ μ©κΉμ§€ μ™„μ „ν• μ—­λ‰μ„ κ°–μ¶”κ² λ©λ‹λ‹¤! π€β¨
